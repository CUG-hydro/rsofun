<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prepare rsofun forcing data â€¢ rsofun</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Prepare rsofun forcing data">
<meta property="og:description" content="rsofun">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rsofun</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example.html">Example for using rsofun</a>
    </li>
    <li>
      <a href="../articles/prepare_inputs_rsofun.html">Prepare rsofun forcing data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stineb/rsofun/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Prepare rsofun forcing data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stineb/rsofun/blob/master/vignettes/prepare_inputs_rsofun.Rmd"><code>vignettes/prepare_inputs_rsofun.Rmd</code></a></small>
      <div class="hidden name"><code>prepare_inputs_rsofun.Rmd</code></div>

    </div>

    
    
<p>The following describes how to use the <a href="https://stineb.github.io/ingestr/">ingestr R package</a> for collecting the forcing data and create the object <code>df_drivers</code>, required as an input (forcing) to rsofun. Here, it contains data for just a single site.</p>
<div id="site-selection-and-meta-data" class="section level3">
<h3 class="hasAnchor">
<a href="#site-selection-and-meta-data" class="anchor"></a>Site selection and meta data</h3>
<p>We manually define a subset of sites that are part of the FLUXNET 2015 Tier 1 set of sites:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="co"># mysites &lt;- c("BE-Vie", "DE-Tha", "DK-Sor", "FI-Hyy", "IT-Col", "NL-Loo", "US-MMS", "US-WCr", "US-UMB", "US-Syv", "FR-Pue")</span>
<span class="no">mysites</span> <span class="kw">&lt;-</span> <span class="st">"FR-Pue"</span></pre></body></html></div>
<p>A small number of meta data variables have to be specified for each site specifically to define the simulation years. This information is also used for input, calibration, and evaluation data ingestion. Required meta information is specified for each site (in rows) and a number of variables:</p>
<ul>
<li>
<code>lat</code> for latitude (decimal degrees)</li>
<li>
<code>lon</code> for longitude (decimal degrees) - this is only used for data ingestion but not for the P-model simulation with <code>rsofun</code>.</li>
<li>
<code>elv</code> for elevation (m a.s.l.)</li>
<li>
<code>year_start</code> and <code>year_end</code> specifying years covered by the simulation</li>
<li>
<code>whc</code> for the soil water holding capacity</li>
<li>
<code>koeppen_code</code> to group sites for evaluation by Koeppen-Geiger climate zones.</li>
</ul>
<p>This information is provided in file <code>siteinfo_fluxnet2015.csv</code>. This file is created as described in (and using code from) <a href="https://github.com/stineb/metainfo_fluxnet2015">metainfo_fluxnet2015</a>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">siteinfo</span> <span class="kw">&lt;-</span> <span class="kw pkg">ingestr</span><span class="kw ns">::</span><span class="no">siteinfo_fluxnet2015</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">sitename</span> <span class="kw">%in%</span> <span class="no">mysites</span>)

<span class="co">## take only year 2007 to 2014, corresponding to subset of data for site FR-Pue provided in this package as demo</span>
<span class="no">siteinfo</span> <span class="kw">&lt;-</span> <span class="no">siteinfo</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">year_start</span> <span class="kw">=</span> <span class="fl">2007</span>, <span class="kw">year_end</span> <span class="kw">=</span> <span class="fl">2014</span>)

<span class="no">siteinfo</span> <span class="kw">&lt;-</span> <span class="no">siteinfo</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">date_start</span> <span class="kw">=</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">year_start</span>, <span class="st">"-01-01"</span>))) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">date_end</span> <span class="kw">=</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">year_end</span>, <span class="st">"-12-31"</span>)))</pre></body></html></div>
</div>
<div id="simulation-settings" class="section level3">
<h3 class="hasAnchor">
<a href="#simulation-settings" class="anchor"></a>Simulation settings</h3>
<p>Specify additional simulation parameters that are identical for all site-scale simulations.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">params_siml</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
  <span class="kw">spinup</span>             <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">spinupyears</span>        <span class="kw">=</span> <span class="fl">10</span>,
  <span class="kw">recycle</span>            <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">soilmstress</span>        <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">tempstress</span>         <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">calc_aet_fapar_vpd</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">in_ppfd</span>            <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">in_netrad</span>          <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">outdt</span>              <span class="kw">=</span> <span class="fl">1</span>,
  <span class="kw">ltre</span>               <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">ltne</span>               <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">ltrd</span>               <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">ltnd</span>               <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">lgr3</span>               <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">lgn3</span>               <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">lgr4</span>               <span class="kw">=</span> <span class="fl">FALSE</span>
    )</pre></body></html></div>
<p>Run <code><a href="../reference/prepare_setup_sofun.html">prepare_setup_sofun()</a></code> to define the simulation settings that contain all the information specified by the two steps above (meta info, and simulation parameters), global simulation parameters are wrapped inside an additional column <code>params_siml</code>, added to the site meta info dataframe.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">siteinfo</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/prepare_setup_sofun.html">prepare_setup_sofun</a></span>(<span class="kw">siteinfo</span> <span class="kw">=</span> <span class="no">siteinfo</span>, <span class="kw">params_siml</span> <span class="kw">=</span> <span class="no">params_siml</span>)</pre></body></html></div>
</div>
<div id="define-model-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#define-model-parameters" class="anchor"></a>Define model parameters</h3>
<p>First, letâ€™s do it by hand (calibration of parameters is shown later).</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">params_modl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="kw">kphio</span>           <span class="kw">=</span> <span class="fl">0.05</span>,
    <span class="kw">soilm_par_a</span>     <span class="kw">=</span> <span class="fl">1.0</span>,
    <span class="kw">soilm_par_b</span>     <span class="kw">=</span> <span class="fl">0.0</span>,
    <span class="kw">vpdstress_par_a</span> <span class="kw">=</span> <span class="fl">0.2</span>,
    <span class="kw">vpdstress_par_b</span> <span class="kw">=</span> <span class="fl">0.2</span>,
    <span class="kw">vpdstress_par_m</span> <span class="kw">=</span> <span class="fl">5</span>
    )</pre></body></html></div>
</div>
<div id="define-soil-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#define-soil-parameters" class="anchor"></a>Define soil parameters</h3>
<p>For now, this is implemented as an illustration. Should be made site-specific. Values entered here take no effect.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">df_soiltexture</span> <span class="kw">&lt;-</span> <span class="fu">bind_rows</span>(
  <span class="kw">top</span>    <span class="kw">=</span> <span class="fu">tibble</span>(<span class="kw">layer</span> <span class="kw">=</span> <span class="st">"top"</span>,    <span class="kw">fsand</span> <span class="kw">=</span> <span class="fl">0.4</span>, <span class="kw">fclay</span> <span class="kw">=</span> <span class="fl">0.3</span>, <span class="kw">forg</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">fgravel</span> <span class="kw">=</span> <span class="fl">0.1</span>),
  <span class="kw">bottom</span> <span class="kw">=</span> <span class="fu">tibble</span>(<span class="kw">layer</span> <span class="kw">=</span> <span class="st">"bottom"</span>, <span class="kw">fsand</span> <span class="kw">=</span> <span class="fl">0.4</span>, <span class="kw">fclay</span> <span class="kw">=</span> <span class="fl">0.3</span>, <span class="kw">forg</span> <span class="kw">=</span> <span class="fl">0.1</span>, <span class="kw">fgravel</span> <span class="kw">=</span> <span class="fl">0.1</span>)
)</pre></body></html></div>
</div>
<div id="get-input" class="section level3">
<h3 class="hasAnchor">
<a href="#get-input" class="anchor"></a>Get input</h3>
<p>Input data, used as model forcing, is collected using the <a href="https://stineb.github.io/ingestr/">ingestr</a> package. A brief description for how to use it for our present application is provided here. Data is collected by data source.</p>
<div id="meteo-data" class="section level4">
<h4 class="hasAnchor">
<a href="#meteo-data" class="anchor"></a>Meteo data</h4>
<p>The following ingests meteorological data from the FLUXNET 2015 files for variables temperature, precipitation, VPD, shortwave incoming radiation, net radiation, and atmospheric pressure. Arguments that are specific for this data source are provided in the <code>settings</code> list. The data object <code>ddf_fluxnet</code> is organised as a nested table with rows for sites and time series nested inside the column <code>data</code>. See <a href="https://tidyr.tidyverse.org/reference/nest.html">here</a> for how to handle nested dataframes.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ingestr</span>)
<span class="no">ddf_fluxnet</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ingestr/man/ingest.html">ingest</a></span>(
  <span class="kw">siteinfo</span>  <span class="kw">=</span> <span class="no">siteinfo</span>,
  <span class="kw">source</span>    <span class="kw">=</span> <span class="st">"fluxnet"</span>,
  <span class="kw">getvars</span>   <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">temp</span> <span class="kw">=</span> <span class="st">"TA_F_DAY"</span>, <span class="kw">prec</span> <span class="kw">=</span> <span class="st">"P_F"</span>, <span class="kw">vpd</span>  <span class="kw">=</span> <span class="st">"VPD_F_DAY"</span>, <span class="kw">ppfd</span> <span class="kw">=</span>  <span class="st">"SW_IN_F"</span>, <span class="kw">patm</span> <span class="kw">=</span> <span class="st">"PA_F"</span>),
  <span class="kw">dir</span>       <span class="kw">=</span> <span class="st">"~/data/FLUXNET-2015_Tier1/20191024/DD/"</span>,
  <span class="kw">settings</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">dir_hh</span> <span class="kw">=</span> <span class="st">"~/data/FLUXNET-2015_Tier1/20191024/HH/"</span>, <span class="kw">getswc</span> <span class="kw">=</span> <span class="fl">FALSE</span>),
  <span class="kw">timescale</span> <span class="kw">=</span> <span class="st">"d"</span>
  )</pre></body></html></div>
<p>Some meteo data is not available from FLUXNET. Extract it from CRU global climate files instead.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">ddf_cru</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ingestr/man/ingest.html">ingest</a></span>(
  <span class="kw">siteinfo</span>  <span class="kw">=</span> <span class="no">siteinfo</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">sitename</span> <span class="kw">%in%</span> <span class="no">mysites</span>),
  <span class="kw">source</span>    <span class="kw">=</span> <span class="st">"cru"</span>,
  <span class="kw">getvars</span>   <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">ccov</span> <span class="kw">=</span> <span class="st">"cld"</span>),
  <span class="kw">dir</span>       <span class="kw">=</span> <span class="st">"~/data/cru/ts_4.01/"</span>
  )</pre></body></html></div>
<pre><code>## Warning in .varName(nc, varname, warn = warn): varname used is: cld
## If that is not correct, you can set it to one of: cld, stn</code></pre>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<p>Combine the two meteo data frames into one, containing <code>ccov</code> (cloud cover) from CRU and all other variables from FLUXNET.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">ddf_meteo</span> <span class="kw">&lt;-</span> <span class="no">ddf_fluxnet</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span>(<span class="no">data</span>) <span class="kw">%&gt;%</span>
  <span class="fu">left_join</span>(
    <span class="no">ddf_cru</span> <span class="kw">%&gt;%</span>
      <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span>(<span class="no">data</span>),
    <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sitename"</span>, <span class="st">"date"</span>)
  ) <span class="kw">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="no">sitename</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span>()</pre></body></html></div>
</div>
<div id="fapar-data" class="section level4">
<h4 class="hasAnchor">
<a href="#fapar-data" class="anchor"></a>fAPAR data</h4>
<p>fAPAR data is prescribed in the P-model setup. The following extracts data MODIS FPAR data from Google Earth Engine (see a complete description for how to set up the GEE API and download library <a href="https://stineb.github.io/ingestr/articles/example.html#google-earth-engine">here</a>).</p>
<p>The following example is for downloading MODIS FPAR data (MODIS/006/MCD15A3H, band Fpar).</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">settings_gee</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_settings_gee.html">get_settings_gee</a></span>(
  <span class="kw">bundle</span> <span class="kw">=</span> <span class="st">"modis_fpar"</span>,
  <span class="kw">python_path</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span>(<span class="st">"which python"</span>, <span class="kw">intern</span> <span class="kw">=</span> <span class="fl">TRUE</span>),
  <span class="kw">gee_path</span> <span class="kw">=</span> <span class="st">"~/google_earth_engine_subsets/gee_subset/"</span>,
  <span class="kw">data_path</span> <span class="kw">=</span> <span class="st">"~/data/gee_subsets/"</span>,
  <span class="kw">method_interpol</span> <span class="kw">=</span> <span class="st">"linear"</span>,
  <span class="kw">keep</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">overwrite_raw</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">overwrite_interpol</span> <span class="kw">=</span> <span class="fl">TRUE</span>
  )</pre></body></html></div>
<p>This can now be used to download the data to the directory specified by argument <code>data_path</code> of function <code><a href="../reference/get_settings_gee.html">get_settings_gee()</a></code> and to read data into R.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">df_gee_modis_fpar</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ingestr/man/ingest.html">ingest</a></span>(
  <span class="kw">siteinfo</span>  <span class="kw">=</span> <span class="no">siteinfo</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">sitename</span> <span class="kw">%in%</span> <span class="no">mysites</span>),
  <span class="kw">source</span> <span class="kw">=</span> <span class="st">"gee"</span>,
  <span class="kw">settings</span> <span class="kw">=</span> <span class="no">settings_gee</span>,
  <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>
  )</pre></body></html></div>
<pre><code>## Parsed with column specification:
## cols(
##   id = col_character(),
##   longitude = col_double(),
##   latitude = col_double(),
##   date = col_date(format = ""),
##   Fpar = col_double(),
##   FparLai_QC = col_double(),
##   product = col_character()
## )</code></pre>
<pre><code>## linear ...</code></pre>
<pre><code>## Warning: Filling values with last available data point at head</code></pre>
<pre><code>## Warning: Filling values with last available data point at tail.</code></pre>
</div>
<div id="co2" class="section level4">
<h4 class="hasAnchor">
<a href="#co2" class="anchor"></a>CO2</h4>
<p>Ingesting CO2 data is particularly simple. We can safely assume itâ€™s well mixed in the atmosphere (independent of site location), and we can use a annual mean value for all days in respective years.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">df_co2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ingestr/man/ingest.html">ingest</a></span>(
  <span class="kw">siteinfo</span>  <span class="kw">=</span> <span class="no">siteinfo</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">sitename</span> <span class="kw">%in%</span> <span class="no">mysites</span>),
  <span class="kw">source</span> <span class="kw">=</span> <span class="st">"co2"</span>,
  <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
  <span class="kw">settings</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">path</span> <span class="kw">=</span> <span class="st">"~/data/co2/cCO2_rcp85_const850-1765.csv"</span>)
  )</pre></body></html></div>
<pre><code>## Parsed with column specification:
## cols(
##   year = col_double(),
##   co2 = col_double()
## )</code></pre>
</div>
<div id="collect-all-drivers" class="section level4">
<h4 class="hasAnchor">
<a href="#collect-all-drivers" class="anchor"></a>Collect all drivers</h4>
<p>Finally, we can collect forcing data, simulation parameters, and site meta info into a single object that will be used to drive rsofun.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">df_drivers</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/collect_drivers_sofun.html">collect_drivers_sofun</a></span>(
  <span class="kw">siteinfo</span>       <span class="kw">=</span> <span class="no">siteinfo</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">sitename</span> <span class="kw">%in%</span> <span class="no">mysites</span>),
  <span class="kw">meteo</span>          <span class="kw">=</span> <span class="no">ddf_meteo</span>,
  <span class="kw">fapar</span>          <span class="kw">=</span> <span class="no">df_gee_modis_fpar</span>,
  <span class="kw">co2</span>            <span class="kw">=</span> <span class="no">df_co2</span>,
  <span class="kw">df_soiltexture</span> <span class="kw">=</span> <span class="no">df_soiltexture</span>
  )
<span class="no">df_drivers</span></pre></body></html></div>
<pre><code>## # A tibble: 1 x 5
##   sitename params_siml       siteinfo         df_soiltexture  forcing           
##   &lt;chr&gt;    &lt;list&gt;            &lt;list&gt;           &lt;list&gt;          &lt;list&gt;            
## 1 FR-Pue   &lt;tibble [1 Ã— 18]&gt; &lt;tibble [1 Ã— 12â€¦ &lt;tibble [2 Ã— 5â€¦ &lt;tibble [2,920 Ã— â€¦</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Benjamin Stocker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
